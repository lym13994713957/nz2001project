"use strict";function _classCallCheck(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}function _createClass(t,i,s){return i&&_defineProperties(t.prototype,i),s&&_defineProperties(t,s),t}!function(){var i=function(){function i(t){_classCallCheck(this,i),this.sBox=$(".small-pic").get(0),this.sImg=$(".small-pic img").get(0),this.sSpan=$(".small-pic span").get(0),this.bBox=$(".big-pic").get(0),this.bImg=$(".big-pic img").get(0),this.li=$(".img-list li"),this.imgData=t,this.addEvent()}return _createClass(i,[{key:"addEvent",value:function(){var i=this,s=this;this.sBox.onmouseover=function(){s.over()},this.sBox.onmousemove=function(t){var i=t||window.event;s.move(i)},this.sBox.onmouseout=function(){s.out()};for(var t=0;t<this.li.length;t++)!function(t){i.li[t].onclick=function(){s.sImg.src=s.imgData[t],s.bImg.src=s.imgData[t]}}(t)}},{key:"over",value:function(){this.sSpan.style.display="block",this.bBox.style.display="block"}},{key:"move",value:function(t){var i=t.offsetX-this.sSpan.offsetWidth/2,s=t.offsetY-this.sSpan.offsetHeight/2;i<0&&(i=0),s<0&&(s=0),i>this.sBox.offsetWidth-this.sSpan.offsetWidth&&(i=this.sBox.offsetWidth-this.sSpan.offsetWidth),s>this.sBox.offsetHeight-this.sSpan.offsetHeight&&(s=this.sBox.offsetHeight-this.sSpan.offsetHeight),this.sSpan.style.left=i+"px",this.sSpan.style.top=s+"px";var e=i/(this.sBox.offsetWidth-this.sSpan.offsetWidth),a=s/(this.sBox.offsetHeight-this.sSpan.offsetHeight);this.bImg.style.left=(this.bBox.offsetWidth-this.bImg.offsetWidth)*e+"px",this.bImg.style.top=(this.bBox.offsetHeight-this.bImg.offsetHeight)*a+"px"}},{key:"out",value:function(){this.sSpan.style.display="none",this.bBox.style.display="none"}}]),i}(),t=function(){function t(){_classCallCheck(this,t),this.tit=$(".title"),this.imgList=$(".img-list"),this.price=$(".price"),this.format=$(".formated"),this.tot=$(".tot-money"),this.tabtit=$(".tab-tit li"),this.tablist=$(".tab-list li"),this.plus=$(".plus"),this.minus=$(".minus"),this.num=$("#num"),this.buy=$(".buy"),this.sImg=$(".small-pic img").get(0),this.bImg=$(".big-pic img").get(0),this.getDate(),this.load()}return _createClass(t,[{key:"getDate",value:function(){this.id=location.search.slice(1).split("=")[1]}},{key:"load",value:function(){var i,s=this;localStorage.getItem("lecart")&&(i=0,JSON.parse(localStorage.getItem("lecart")).forEach(function(t){i+=Number(t.num)}),$(".buynum").html(i)),$.getJSON("../data/thing.json",function(t){for(var i=0;i<t.length;i++)s.id==t[i].id&&(s.data=t[i],s.display())})}},{key:"display",value:function(){for(var t=0;t<this.tit.length;t++)$(this.tit[t]).html("".concat(this.data.name));for(var i=0;i<this.data.imgSrc.length;i++)this.imgList.append("<li>\n                <img src=".concat(this.data.imgSrc[i],' alt="">\n            </li> '));this.sImg.src=this.data.imgSrc[0],this.bImg.src=this.data.imgSrc[0],this.price.html("".concat(this.data.Nprice)),this.tot.html("".concat(this.data.Nprice)),this.format.html("".concat(this.data.format));for(var s=0;s<this.data.msg.length;s++)$(this.tablist[0]).append("<img src = ".concat(this.data.msg[s],">"));this.addEvent()}},{key:"addEvent",value:function(){var t=this,s=this;new i(this.data.imgSrc),this.plus.click(function(){s.num.val(function(t,i){return parseInt(i)+1}),s.tot.html(function(){return(parseFloat(s.tot.html())+parseFloat(s.data.Nprice)).toFixed(2)})}),this.minus.click(function(){s.num.val()<=1||(s.num.val(function(t,i){return parseInt(i)-1}),s.tot.html(function(){return(parseFloat(s.tot.html())-parseFloat(s.data.Nprice)).toFixed(2)}))}),this.tabtit.each(function(t,i){$(i).click(function(){$(this).addClass("active").siblings().removeClass("active"),s.tablist.eq(t).addClass("active").siblings().removeClass("active")})}),window.onscroll=function(){805<$(window).scrollTop()?$(t.tabtit[0]).parent().parent().addClass("fix"):$(t.tabtit[0]).parent().parent().removeClass("fix")},this.buy.click(function(){s.setDate()})}},{key:"setDate",value:function(){var t=window.localStorage,i=t.getItem("lecart")?JSON.parse(t.getItem("lecart")):[];if(0===i.length)i=[{goodsId:this.id,num:this.num.val(),msg:this.data}];else{for(var s=0,e=0;e<i.length;e++)if(i[e].goodsId===this.id){i[e].num=parseInt(i[e].num)+parseInt(this.num.val()),s=1;break}0==s&&i.push({goodsId:this.id,num:this.num.val(),msg:this.data})}t.setItem("lecart",JSON.stringify(i));for(var a=0,n=0;n<i.length;n++)a+=Number(i[n].num);$(".buynum").html(a),confirm("已加入购物车，是否前往购物车查看")&&(location.href="cart.html")}}]),t}();$(".category a").each(function(){this.href="list.html"}),$(".cart").click(function(){$.cookie("login")?location.href="cart.html":confirm("你还没有登录，请先登录，是否跳转到登录页面")&&(location.href="login.html")}),new t}();