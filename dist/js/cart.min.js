"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var c=0;c<e.length;c++){var n=e[c];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,c){return e&&_defineProperties(t.prototype,e),c&&_defineProperties(t,c),t}new(function(){function t(){_classCallCheck(this,t),this.tab=$(".tab"),this.tbody=$("tbody"),this.tnum=$(".tonum"),this.tmoney=$(".totalmoney"),this.clean=$(".clean"),this.toNum=this.toMoney=0,this.getDate()}return _createClass(t,[{key:"getDate",value:function(){localStorage.getItem("lecart")?this.gm=JSON.parse(localStorage.getItem("lecart")):this.gm=[],this.createTbody()}},{key:"createTbody",value:function(){if(!this.gm.length<1){this.clean.css("display","none"),this.tab.css("display","block");for(var t=0;t<this.gm.length;t++)this.tbody.append('<tr data-good-id="'.concat(this.gm[t].id,'">\n                    <td>\n                        <input type="checkbox" checked class="check">\n                    </td>\n                    <td class="showmsg">\n                        <img src="').concat(this.gm[t].msg.imgSrc[0],'" alt="">\n                        <a class="title" href="detail.html?id=').concat(this.gm[t].id,'">\n                        ').concat(this.gm[t].msg.name,'\n                        </a>\n                    </td>\n                    <td class="price">').concat(this.gm[t].msg.Nprice,'</td>\n                    <td class="numtd">\n                        <div class="minus">-</div>\n                        <input type="text" class="num" value="').concat(this.gm[t].num,'">\n                        <div class="plus">+</div>\n                    </td>\n                    <td class="tot">').concat((this.gm[t].num*this.gm[t].msg.Nprice).toFixed(2),'</td>\n                    <td class="del">删除</td>\n                </tr>')),this.toNum+=Number(this.gm[t].num),this.toMoney+=this.gm[t].num*this.gm[t].msg.Nprice;this.checkF(),this.getEle()}}},{key:"getEle",value:function(){this.minus=$(".minus"),this.plus=$(".plus"),this.num=$(".num"),this.tot=$(".tot"),this.check=$(".check"),this.del=$(".del"),this.checkAll=$("#checkAll"),this.cleanAll=$(".cleanAll"),this.addEvent()}},{key:"addEvent",value:function(){var c=this;this.plus.each(function(t,e){$(e).click(function(){c.num[t].value++,c.gm[t].num++,$(c.tot[t]).html(function(){return(parseFloat($(c.tot[t]).html())+parseFloat(c.gm[t].msg.Nprice)).toFixed(2)}),c.check[t].checked&&(c.toNum++,c.checkF(),c.toMoney+=parseFloat(c.gm[t].msg.Nprice)),localStorage.setItem("lecart",JSON.stringify(c.gm))})}),this.minus.each(function(t,e){$(e).click(function(){1!=c.num[t].value&&(c.num[t].value--,c.gm[t].num--,$(c.tot[t]).html(function(){return(parseFloat($(c.tot[t]).html())-parseFloat(c.gm[t].msg.Nprice)).toFixed(2)}),c.check[t].checked&&(c.toNum--,c.checkF(),c.toMoney-=parseFloat(c.gm[t].msg.Nprice)),localStorage.setItem("lecart",JSON.stringify(c.gm)))})}),this.del.each(function(t,e){$(e).click(function(){confirm("确认删除这个商品吗？")&&($(this).parent().remove(),c.gm.splice(t,1),localStorage.setItem("lecart",JSON.stringify(c.gm)),c.toNum-=c.num[t].value,c.checkF(),c.toMoney-=c.tot[t].innerHTML,c.minus=$(".minus"),c.plus=$(".plus"),c.num=$(".num"),c.tot=$(".tot"),c.check=$(".check"),c.del=$(".del"))})}),this.cleanAll.click(function(){confirm("确认要清空整个购物车吗？")&&(c.tab.css("display","none").html(""),c.clean.css("display","block"),localStorage.removeItem("lecart"))}),this.checkAll.click(function(){if(c.check.each(function(t,e){e.checked=c.checkAll[0].checked}),c.checkAll[0].checked){for(var t=c.toNum=c.toMoney=0;t<c.gm.length;t++)c.toNum+=Number(c.gm[t].num),c.toMoney+=parseFloat(c.gm[t].num*c.gm[t].msg.Nprice);c.checkF()}else c.toNum=c.toMoney=0,c.tnum.html("0"),c.tmoney.html("0")}),this.check.each(function(t,e){$(e).on("click",function(){this.checked?($.makeArray(c.check).every(function(t){return t.checked})&&(c.checkAll[0].checked=!0),c.toNum+=Number(c.num[t].value),c.toMoney+=parseFloat(c.tot[t].innerHTML)):(c.checkAll[0].checked=!1,c.toNum-=c.num[t].value,c.toMoney-=c.tot[t].innerHTML),c.checkF()})}),this.num.each(function(t,e){$(e).change(function(){(isNaN(this.value)||this.value<1)&&(this.value=1),$(c.tot[t]).html(function(){return(c.gm[t].msg.Nprice*c.num[t].value).toFixed(2)}),c.gm[t].num=this.value,localStorage.setItem("lecart",JSON.stringify(c.gm)),c.check[t].checked&&(c.toNum=c.toMoney=0,c.check.each(function(t,e){c.check[t].checked&&(c.toNum+=Number(c.num[t].value),c.toMoney+=Number(c.tot[t].innerHTML),c.checkF())}))})})}},{key:"checkF",value:function(){this.tnum.html(this.toNum),this.tmoney.html(this.toMoney.toFixed(2))}}]),t}());